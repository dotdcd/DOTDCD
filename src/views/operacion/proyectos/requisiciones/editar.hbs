 <div>
  <input type="text" id="search-input" placeholder="Enter product name">
  <ul id="products-list"></ul>
</div>

 <div class="row">
    <div class="col-xl-12">
        <div id="panel-1" class="panel">
            <div class="panel-hdr">
                <h2>
                    Editar Producto o Servicio <span class="fw-300"><i>DOTDCD - ERP</i></span>
                </h2>
                <div class="panel-toolbar">
                    <button class="btn btn-panel" data-action="panel-collapse" data-toggle="tooltip" data-offset="0,10"
                        data-original-title="Collapse"></button>
                    <button class="btn btn-panel" data-action="panel-fullscreen" data-toggle="tooltip"
                        data-offset="0,10" data-original-title="Fullscreen"></button>
                    <button class="btn btn-panel" data-action="panel-close" data-toggle="tooltip" data-offset="0,10"
                        data-original-title="Close"></button>
                </div>
            </div>
            <div class="panel-container show">
                <div class="panel-content">
                    <div id="metasAll">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-3"></div>
                                <div class="col-md-12">
                                    <!-- Formulario  -->
                                    <table class="table table-striped table-hover table-info table-bordered ">
                                        <tr>
                                            <th>Concepto</th>
                                            <th>Valor</th>
                                        </tr>
                                        <tr>
                                            <td class="font-weight-bold">Requisicion</td>
                                            <td colspan="3">{{r.requisicion_id}}</td>
                                        </tr>
                                        <tr>
                                            <td class="font-weight-bold">Solicitante</td>
                                            <td>{{r.nombre_completo}}</td>
                                            
                                            

                                        </tr>
                                        <tr>
                                            <td class="font-weight-bold">
                                                Disciplina
                                            </td>
                                            <td>{{r.familia_descripcion}}</td>
                                            
                                        </tr>
                                        <tr>
                                            <td class="font-weight-bold">Proyecto</td>
                                            <td>{{r.cotizacion_proyecto}}</td>
                                        </tr>
                                        <tr>
                                            <td class="font-weight-bold">Cliente</td>
                                            <td>{{info.cliente_razon_social}}</td>
                                        </tr>
                                        <tr><td class="font-weight-bold">Fecha</td>
                                            <td>{{r.fecha}}</td></tr>
                                        <tr>
                                            <td class="font-weight-bold">Tipo de Requisicion</td>
                                            <td id="tipo"></td>
                                        </tr>
                                    </table>

                                    <table class="table table-striped table-hover table-info table-bordered ">
                                        <tr class="text-center">
                                            <th>Producto</th>
                                            <th>Marca</th>
                                            <th>Modelo</th>
                                            <th>Requeridos</th>
                                            <th>Ordenados</th>
                                            <th>Por requerir</th>
                                            <th>Fecha Entrega</th>
                                            <th>Acciones</th>
                                        </tr>
                                            {{#each lista}}
                                        <tr>
                                            <td>{{producto_descripcion}}</td>
                                            <td>{{marca_descripcion}}</td>
                                            <td>{{producto_modelo}}</td>
                                            <td class="text-center">{{requerido}}</td>
                                            <td class="text-center">{{partida_cantidad}}</td>
                                            <td class="text-center">{{partida_cantidad}}</td>
                                            <td>{{orden_fecha_entrega}}</td>
                                            <td> <button class="btn btn-danger" type="button">Eliminar</button> </td>
                                        </tr>
                                            {{/each}}
                                            <tr>
                                                <td><button class="btn btn-info" type="button" id="addProducto">Buscar Producto</button></td>
                                            </tr>
                                    </table>
                                    <div class="col-md-3"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-xl-12">
        <div id="panel-1" class="panel">
            <div class="panel-hdr">
                <h2>
                    Editar Producto o Servicio <span class="fw-300"><i>DOTDCD - ERP</i></span>
                </h2>
                <div class="panel-toolbar">
                    <button class="btn btn-panel" data-action="panel-collapse" data-toggle="tooltip" data-offset="0,10"
                        data-original-title="Collapse"></button>
                    <button class="btn btn-panel" data-action="panel-fullscreen" data-toggle="tooltip"
                        data-offset="0,10" data-original-title="Fullscreen"></button>
                    <button class="btn btn-panel" data-action="panel-close" data-toggle="tooltip" data-offset="0,10"
                        data-original-title="Close"></button>
                </div>
            </div>
            <div class="panel-container show">
                <div class="panel-content">
                    <div id="metasAll">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-3"></div>
                                <div class="col-md-6">
                                    <!-- Formulario  -->
                                    <form class="form-group" method="post"
                                        action="/updRequisicion/{{r.requisicion_id}}">
                                        <label class="form-label col-12" for="simpleinput">
                                            <h3 class="text-center">Editar Requisicion</h3>
                                        </label><br /><br /><br />

                                        <span>Tipo de requisicion</span>
                                        <select name="" id="tipo_requisicion" onchange="cambio()" class="form-control">
                                            <option value=""></option>
                                            <option value="0" {{#if (is r.tipo_id  0)}} selected {{/if}}>Listado de Productos</option>
                                            <option value="1"{{#if (is r.tipo_id  1)}} selected {{/if}}>Proyecto</option>
                                        </select><br /><br />

                                        <span>Cliente</span>
                                        <select name="" id="" class="form-control">
                                            {{#each clientes}}
                                            <option value="{{cliente_id}}" >{{cliente_razon_social}}</option>
                                            {{/each}}
                                        </select><br /><br />

                                        <span>Proyecto / Cotizacion</span>
                                        <input type="text" name="" class="form-control" id="searchInput">
                                        <select name="requisicion_cotizacion_id" onkeyup="searchFunction()"  id="mySelect" class="form-control">
                                            {{#each cotizaciones}}
                                            <option value="{{cotizacion_id}}" {{#if (is ../r.cotizacion_id cotizacion_id)}} selected {{/if}}>{{cotizacion_descripcion}}</option>
                                            {{/each}}
                                        </select><br />

                                        <span>Inversion</span>
                                        <select name="" id="" class="form-control">
                                            <option value="" selected></option>
                                            {{#each inversion}}
                                            <option value="{{inversion_id}}" {{#if (is ../r.requisicion_inversion_id inversion_id)}} selected {{/if}}>{{inversion_descripcion}}</option>
                                            {{/each}}
                                        </select><br />

                                        <span>Familia / Disciplina</span>
                                        <select name="" id="" class="form-control">
                                            {{#each familias}}
                                            <option value="{{familia_id}}" {{#if (is ../r.requisicion_diciplina_id familia_id)}} selected {{/if}}>{{familia_descripcion}}</option>
                                            {{/each}}
                                        </select><br />

                                        <span>Empleado Solicitante</span>
                                        <select name="requisicion_empleado_id" id="" class="form-control">
                                            {{#each empleados}}
                                            <option value="{{empleado_id}}" {{#if (is ../r.requisicion_empleado_id empleado_id) }} selected {{/if}}>{{nombre_completo}}</option>
                                            {{/each}}
                                        </select><br />

                                        <span>Fecha</span>
                                        <input type="date" class="form-control" value="{{r.fecha}}" name="fecha"><br />

                                        <span>Comentarios</span>
                                        <input type="text" class="form-control" value="{{r.requisicion_comentarios}}"
                                            name="requisicion_comentarios"><br />

                                        <br><br>
                                        <button type="submit"
                                            class="btn-outline-info btn-lg btn-block ">Actualizar</button>
                                    </form>
                                    <div class="col-md-3"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{{#section "scripts"}}
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.5/axios.min.js" integrity="sha512-JEXkqJItqNp0+qvX53ETuwTLoz/r1Tn5yTRnZWWz0ghMKM2WFCEYLdQnsdcYnryMNANMAnxNcBa/dN7wQtESdw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>

<script>





var products = []
const productsList = document.querySelector("#products-list");
productsList.innerHTML = "";
for (const product of products) {
  productsList.innerHTML += `<li>${product.name}</li>`;
}

const input = document.querySelector("#search-input");
input.addEventListener("keyup", () => {
  const searchText = input.value;
  if (searchText.length > 2) {
    $.ajax({
      type: "GET",
      url: `/getProducto?searchText=${searchText}`,
      success: (data) => {
        const products = data;
        const productsList = document.querySelector("#products-list");
        productsList.innerHTML = "";
        for (const product of products) {
          productsList.innerHTML += `<a><li>${product["producto_descripcion"]}</li></a>`;
        }
      }
    });
  }
});






    function searchFunction() {
  // Declare variables
  var input, filter, select, option, i, txtValue;
  input = document.getElementById("searchInput");
  filter = input.value.toUpperCase();
  select = document.getElementById("mySelect");
  option = select.getElementsByTagName("option");

  // Loop through all options, and hide those who don't match the search query
  for (i = 0; i < option.length; i++) {
    txtValue = option[i].textContent;
    if (txtValue.toUpperCase().indexOf(filter) > -1) {
      option[i].style.display = "";
    } else {
      option[i].style.display = "none";
    }
  }
}

    
    
    var tipo = document.getElementById('tipo');
    if (tipoR == 0) {
        tipo.innerHTML = 'Lista de Productos';
    } else {
        tipo.innerHTML = 'Proyecto';
    }
    var tipoR = {{r.tipo_id}}1;
</script>

{{/section}}